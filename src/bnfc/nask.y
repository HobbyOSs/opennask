/* -*- c -*- This Bison file was machine-generated by BNFC */

/* Generate header file for lexer. */
%defines "bison.hh"

/* Reentrant parser */
%define api.pure
  /* From Bison 2.3b (2008): %define api.pure full */
%lex-param   { yyscan_t scanner }
%parse-param { yyscan_t scanner }

/* Turn on line/column tracking in the nask_lloc structure: */
%locations

/* Argument to the parser to be filled with the parsed tree. */
%parse-param { YYSTYPE *result }

%{
/* Begin C preamble code */

#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include "absyn.hh"

#define YYMAXDEPTH 10000000

/* The type yyscan_t is defined by flex, but we need it in the parser already. */
#ifndef YY_TYPEDEF_YY_SCANNER_T
#define YY_TYPEDEF_YY_SCANNER_T
typedef void* yyscan_t;
#endif

typedef struct yy_buffer_state *YY_BUFFER_STATE;
extern YY_BUFFER_STATE nask__scan_string(const char *str, yyscan_t scanner);
extern void nask__delete_buffer(YY_BUFFER_STATE buf, yyscan_t scanner);

extern void nask_lex_destroy(yyscan_t scanner);
extern char* nask_get_text(yyscan_t scanner);

extern yyscan_t nask__initialize_lexer(FILE * inp);

/* End C preamble code */
%}

%union
{
  int    _int;
  char   _char;
  double _double;
  char*  _string;
  Program* program_;
  ListStatement* liststatement_;
  Statement* statement_;
  ListMnemonicArgs* listmnemonicargs_;
  MnemonicArgs* mnemonicargs_;
  Exp* exp_;
  Factor* factor_;
  ConfigType* configtype_;
  DataType* datatype_;
  Opcode* opcode_;
}

%{
void yyerror(YYLTYPE *loc, yyscan_t scanner, YYSTYPE *result, const char *msg)
{
  fprintf(stderr, "error: %d,%d: %s at %s\n",
    loc->first_line, loc->first_column, msg, nask_get_text(scanner));
}

int yyparse(yyscan_t scanner, YYSTYPE *result);

extern int yylex(YYSTYPE *lvalp, YYLTYPE *llocp, yyscan_t scanner);
%}

%token          _ERROR_
%token          _BANGEQ       /* != */
%token          _PERCENT      /* % */
%token          _STAR         /* * */
%token          _PLUS         /* + */
%token          _COMMA        /* , */
%token          _MINUS        /* - */
%token          _SLASH        /* / */
%token          _COLON        /* : */
%token          _LT           /* < */
%token          _LDARROW      /* <= */
%token          _DEQ          /* == */
%token          _GT           /* > */
%token          _GTEQ         /* >= */
%token          _KW_AAA       /* AAA */
%token          _KW_AAD       /* AAD */
%token          _KW_AAM       /* AAM */
%token          _KW_AAS       /* AAS */
%token          _KW_ABSOLUTE  /* ABSOLUTE */
%token          _KW_ADC       /* ADC */
%token          _KW_ADD       /* ADD */
%token          _KW_ALIGN     /* ALIGN */
%token          _KW_ALIGNB    /* ALIGNB */
%token          _KW_AND       /* AND */
%token          _KW_ARPL      /* ARPL */
%token          _KW_BITS      /* BITS */
%token          _KW_BOUND     /* BOUND */
%token          _KW_BSF       /* BSF */
%token          _KW_BSR       /* BSR */
%token          _KW_BSWAP     /* BSWAP */
%token          _KW_BT        /* BT */
%token          _KW_BTC       /* BTC */
%token          _KW_BTR       /* BTR */
%token          _KW_BTS       /* BTS */
%token          _KW_BYTE      /* BYTE */
%token          _KW_CALL      /* CALL */
%token          _KW_CBW       /* CBW */
%token          _KW_CDQ       /* CDQ */
%token          _KW_CLC       /* CLC */
%token          _KW_CLD       /* CLD */
%token          _KW_CLI       /* CLI */
%token          _KW_CLTS      /* CLTS */
%token          _KW_CMC       /* CMC */
%token          _KW_CMP       /* CMP */
%token          _KW_CMPSB     /* CMPSB */
%token          _KW_CMPSD     /* CMPSD */
%token          _KW_CMPSW     /* CMPSW */
%token          _KW_CMPXCHG   /* CMPXCHG */
%token          _KW_CPUID     /* CPUID */
%token          _KW_CWD       /* CWD */
%token          _KW_CWDE      /* CWDE */
%token          _KW_DAA       /* DAA */
%token          _KW_DAS       /* DAS */
%token          _KW_DB        /* DB */
%token          _KW_DD        /* DD */
%token          _KW_DEC       /* DEC */
%token          _KW_DIV       /* DIV */
%token          _KW_DQ        /* DQ */
%token          _KW_DT        /* DT */
%token          _KW_DW        /* DW */
%token          _KW_DWORD     /* DWORD */
%token          _KW_END       /* END */
%token          _KW_ENTER     /* ENTER */
%token          _KW_EQU       /* EQU */
%token          _KW_EXTERN    /* EXTERN */
%token          _KW_F2XM1     /* F2XM1 */
%token          _KW_FABS      /* FABS */
%token          _KW_FADD      /* FADD */
%token          _KW_FADDP     /* FADDP */
%token          _KW_FBLD      /* FBLD */
%token          _KW_FBSTP     /* FBSTP */
%token          _KW_FCHS      /* FCHS */
%token          _KW_FCLEX     /* FCLEX */
%token          _KW_FCOM      /* FCOM */
%token          _KW_FCOMP     /* FCOMP */
%token          _KW_FCOMPP    /* FCOMPP */
%token          _KW_FCOS      /* FCOS */
%token          _KW_FDECSTP   /* FDECSTP */
%token          _KW_FDISI     /* FDISI */
%token          _KW_FDIV      /* FDIV */
%token          _KW_FDIVP     /* FDIVP */
%token          _KW_FDIVR     /* FDIVR */
%token          _KW_FDIVRP    /* FDIVRP */
%token          _KW_FENI      /* FENI */
%token          _KW_FFREE     /* FFREE */
%token          _KW_FIADD     /* FIADD */
%token          _KW_FICOM     /* FICOM */
%token          _KW_FICOMP    /* FICOMP */
%token          _KW_FIDIV     /* FIDIV */
%token          _KW_FIDIVR    /* FIDIVR */
%token          _KW_FILD      /* FILD */
%token          _KW_FILE      /* FILE */
%token          _KW_FIMUL     /* FIMUL */
%token          _KW_FINCSTP   /* FINCSTP */
%token          _KW_FINIT     /* FINIT */
%token          _KW_FIST      /* FIST */
%token          _KW_FISTP     /* FISTP */
%token          _KW_FISUB     /* FISUB */
%token          _KW_FISUBR    /* FISUBR */
%token          _KW_FLD       /* FLD */
%token          _KW_FLD1      /* FLD1 */
%token          _KW_FLDCW     /* FLDCW */
%token          _KW_FLDENV    /* FLDENV */
%token          _KW_FLDL2E    /* FLDL2E */
%token          _KW_FLDL2T    /* FLDL2T */
%token          _KW_FLDLG2    /* FLDLG2 */
%token          _KW_FLDLN2    /* FLDLN2 */
%token          _KW_FLDPI     /* FLDPI */
%token          _KW_FLDZ      /* FLDZ */
%token          _KW_FMUL      /* FMUL */
%token          _KW_FMULP     /* FMULP */
%token          _KW_FNCLEX    /* FNCLEX */
%token          _KW_FNDISI    /* FNDISI */
%token          _KW_FNENI     /* FNENI */
%token          _KW_FNINIT    /* FNINIT */
%token          _KW_FNOP      /* FNOP */
%token          _KW_FNSAVE    /* FNSAVE */
%token          _KW_FNSTCW    /* FNSTCW */
%token          _KW_FNSTENV   /* FNSTENV */
%token          _KW_FNSTSW    /* FNSTSW */
%token          _KW_FORMAT    /* FORMAT */
%token          _KW_FPATAN    /* FPATAN */
%token          _KW_FPREM     /* FPREM */
%token          _KW_FPREM1    /* FPREM1 */
%token          _KW_FPTAN     /* FPTAN */
%token          _KW_FRNDINT   /* FRNDINT */
%token          _KW_FRSTOR    /* FRSTOR */
%token          _KW_FSAVE     /* FSAVE */
%token          _KW_FSCALE    /* FSCALE */
%token          _KW_FSETPM    /* FSETPM */
%token          _KW_FSIN      /* FSIN */
%token          _KW_FSINCOS   /* FSINCOS */
%token          _KW_FSQRT     /* FSQRT */
%token          _KW_FST       /* FST */
%token          _KW_FSTCW     /* FSTCW */
%token          _KW_FSTENV    /* FSTENV */
%token          _KW_FSTP      /* FSTP */
%token          _KW_FSTSW     /* FSTSW */
%token          _KW_FSUB      /* FSUB */
%token          _KW_FSUBP     /* FSUBP */
%token          _KW_FSUBR     /* FSUBR */
%token          _KW_FSUBRP    /* FSUBRP */
%token          _KW_FTST      /* FTST */
%token          _KW_FUCOM     /* FUCOM */
%token          _KW_FUCOMP    /* FUCOMP */
%token          _KW_FUCOMPP   /* FUCOMPP */
%token          _KW_FXAM      /* FXAM */
%token          _KW_FXCH      /* FXCH */
%token          _KW_FXTRACT   /* FXTRACT */
%token          _KW_FYL2X     /* FYL2X */
%token          _KW_FYL2XP1   /* FYL2XP1 */
%token          _KW_HLT       /* HLT */
%token          _KW_IDIV      /* IDIV */
%token          _KW_IMUL      /* IMUL */
%token          _KW_IN        /* IN */
%token          _KW_INC       /* INC */
%token          _KW_INCO      /* INCO */
%token          _KW_INSB      /* INSB */
%token          _KW_INSD      /* INSD */
%token          _KW_INSTRSET  /* INSTRSET */
%token          _KW_INSW      /* INSW */
%token          _KW_INT       /* INT */
%token          _KW_INT3      /* INT3 */
%token          _KW_INTO      /* INTO */
%token          _KW_INVD      /* INVD */
%token          _KW_INVLPG    /* INVLPG */
%token          _KW_IRET      /* IRET */
%token          _KW_IRETD     /* IRETD */
%token          _KW_IRETW     /* IRETW */
%token          _KW_JA        /* JA */
%token          _KW_JAE       /* JAE */
%token          _KW_JB        /* JB */
%token          _KW_JBE       /* JBE */
%token          _KW_JC        /* JC */
%token          _KW_JCXZ      /* JCXZ */
%token          _KW_JE        /* JE */
%token          _KW_JECXZ     /* JECXZ */
%token          _KW_JG        /* JG */
%token          _KW_JGE       /* JGE */
%token          _KW_JL        /* JL */
%token          _KW_JLE       /* JLE */
%token          _KW_JMP       /* JMP */
%token          _KW_JNA       /* JNA */
%token          _KW_JNAE      /* JNAE */
%token          _KW_JNB       /* JNB */
%token          _KW_JNBE      /* JNBE */
%token          _KW_JNC       /* JNC */
%token          _KW_JNE       /* JNE */
%token          _KW_JNG       /* JNG */
%token          _KW_JNGE      /* JNGE */
%token          _KW_JNL       /* JNL */
%token          _KW_JNLE      /* JNLE */
%token          _KW_JNO       /* JNO */
%token          _KW_JNP       /* JNP */
%token          _KW_JNS       /* JNS */
%token          _KW_JNZ       /* JNZ */
%token          _KW_JO        /* JO */
%token          _KW_JP        /* JP */
%token          _KW_JPE       /* JPE */
%token          _KW_JPO       /* JPO */
%token          _KW_JS        /* JS */
%token          _KW_JZ        /* JZ */
%token          _KW_LAHF      /* LAHF */
%token          _KW_LAR       /* LAR */
%token          _KW_LDS       /* LDS */
%token          _KW_LEA       /* LEA */
%token          _KW_LEAVE     /* LEAVE */
%token          _KW_LES       /* LES */
%token          _KW_LFS       /* LFS */
%token          _KW_LGDT      /* LGDT */
%token          _KW_LGS       /* LGS */
%token          _KW_LIDT      /* LIDT */
%token          _KW_LLDT      /* LLDT */
%token          _KW_LMSW      /* LMSW */
%token          _KW_LOCK      /* LOCK */
%token          _KW_LODSB     /* LODSB */
%token          _KW_LODSD     /* LODSD */
%token          _KW_LODSW     /* LODSW */
%token          _KW_LOOP      /* LOOP */
%token          _KW_LOOPE     /* LOOPE */
%token          _KW_LOOPNE    /* LOOPNE */
%token          _KW_LOOPNZ    /* LOOPNZ */
%token          _KW_LOOPZ     /* LOOPZ */
%token          _KW_LSL       /* LSL */
%token          _KW_LSS       /* LSS */
%token          _KW_LTR       /* LTR */
%token          _KW_MOV       /* MOV */
%token          _KW_MOVSB     /* MOVSB */
%token          _KW_MOVSD     /* MOVSD */
%token          _KW_MOVSW     /* MOVSW */
%token          _KW_MOVSX     /* MOVSX */
%token          _KW_MOVZX     /* MOVZX */
%token          _KW_MUL       /* MUL */
%token          _KW_NEG       /* NEG */
%token          _KW_NOP       /* NOP */
%token          _KW_NOT       /* NOT */
%token          _KW_OPTIMIZE  /* OPTIMIZE */
%token          _KW_OR        /* OR */
%token          _KW_ORG       /* ORG */
%token          _KW_OUT       /* OUT */
%token          _KW_OUTSB     /* OUTSB */
%token          _KW_OUTSD     /* OUTSD */
%token          _KW_OUTSW     /* OUTSW */
%token          _KW_PADDING   /* PADDING */
%token          _KW_PADSET    /* PADSET */
%token          _KW_POP       /* POP */
%token          _KW_POPA      /* POPA */
%token          _KW_POPAD     /* POPAD */
%token          _KW_POPAW     /* POPAW */
%token          _KW_POPF      /* POPF */
%token          _KW_POPFD     /* POPFD */
%token          _KW_POPFW     /* POPFW */
%token          _KW_PUSH      /* PUSH */
%token          _KW_PUSHA     /* PUSHA */
%token          _KW_PUSHAD    /* PUSHAD */
%token          _KW_PUSHAW    /* PUSHAW */
%token          _KW_PUSHD     /* PUSHD */
%token          _KW_PUSHF     /* PUSHF */
%token          _KW_PUSHFD    /* PUSHFD */
%token          _KW_PUSHFW    /* PUSHFW */
%token          _KW_RCL       /* RCL */
%token          _KW_RCR       /* RCR */
%token          _KW_RDMSR     /* RDMSR */
%token          _KW_RDPMC     /* RDPMC */
%token          _KW_REP       /* REP */
%token          _KW_REPE      /* REPE */
%token          _KW_REPNE     /* REPNE */
%token          _KW_REPNZ     /* REPNZ */
%token          _KW_REPZ      /* REPZ */
%token          _KW_RESB      /* RESB */
%token          _KW_RESD      /* RESD */
%token          _KW_RESQ      /* RESQ */
%token          _KW_REST      /* REST */
%token          _KW_RESW      /* RESW */
%token          _KW_RET       /* RET */
%token          _KW_RETF      /* RETF */
%token          _KW_RETN      /* RETN */
%token          _KW_ROL       /* ROL */
%token          _KW_ROR       /* ROR */
%token          _KW_RSM       /* RSM */
%token          _KW_SAHF      /* SAHF */
%token          _KW_SAL       /* SAL */
%token          _KW_SAR       /* SAR */
%token          _KW_SBB       /* SBB */
%token          _KW_SCASB     /* SCASB */
%token          _KW_SCASD     /* SCASD */
%token          _KW_SCASW     /* SCASW */
%token          _KW_SECTION   /* SECTION */
%token          _KW_SETA      /* SETA */
%token          _KW_SETAE     /* SETAE */
%token          _KW_SETB      /* SETB */
%token          _KW_SETBE     /* SETBE */
%token          _KW_SETC      /* SETC */
%token          _KW_SETE      /* SETE */
%token          _KW_SETG      /* SETG */
%token          _KW_SETGE     /* SETGE */
%token          _KW_SETL      /* SETL */
%token          _KW_SETLE     /* SETLE */
%token          _KW_SETNA     /* SETNA */
%token          _KW_SETNAE    /* SETNAE */
%token          _KW_SETNB     /* SETNB */
%token          _KW_SETNBE    /* SETNBE */
%token          _KW_SETNC     /* SETNC */
%token          _KW_SETNE     /* SETNE */
%token          _KW_SETNG     /* SETNG */
%token          _KW_SETNGE    /* SETNGE */
%token          _KW_SETNL     /* SETNL */
%token          _KW_SETNLE    /* SETNLE */
%token          _KW_SETNO     /* SETNO */
%token          _KW_SETNP     /* SETNP */
%token          _KW_SETNS     /* SETNS */
%token          _KW_SETNZ     /* SETNZ */
%token          _KW_SETO      /* SETO */
%token          _KW_SETP      /* SETP */
%token          _KW_SETPE     /* SETPE */
%token          _KW_SETPO     /* SETPO */
%token          _KW_SETS      /* SETS */
%token          _KW_SETZ      /* SETZ */
%token          _KW_SGDT      /* SGDT */
%token          _KW_SHL       /* SHL */
%token          _KW_SHLD      /* SHLD */
%token          _KW_SHR       /* SHR */
%token          _KW_SHRD      /* SHRD */
%token          _KW_SIDT      /* SIDT */
%token          _KW_SLDT      /* SLDT */
%token          _KW_SMSW      /* SMSW */
%token          _KW_STC       /* STC */
%token          _KW_STD       /* STD */
%token          _KW_STI       /* STI */
%token          _KW_STOSB     /* STOSB */
%token          _KW_STOSD     /* STOSD */
%token          _KW_STOSW     /* STOSW */
%token          _KW_STR       /* STR */
%token          _KW_SUB       /* SUB */
%token          _KW_TEST      /* TEST */
%token          _KW_TIMES     /* TIMES */
%token          _KW_UD2       /* UD2 */
%token          _KW_VERR      /* VERR */
%token          _KW_VERW      /* VERW */
%token          _KW_WAIT      /* WAIT */
%token          _KW_WBINVD    /* WBINVD */
%token          _KW_WORD      /* WORD */
%token          _KW_WRMSR     /* WRMSR */
%token          _KW_XADD      /* XADD */
%token          _KW_XCHG      /* XCHG */
%token          _KW_XLATB     /* XLATB */
%token          _KW_XOR       /* XOR */
%token          _LBRACK       /* [ */
%token          _RBRACK       /* ] */
%token<_string> T_Hex         /* Hex */
%token<_string> T_Label       /* Label */
%token<_string> _STRING_
%token<_int>    _INTEGER_
%token<_string> _IDENT_

%type <program_> Program
%type <liststatement_> ListStatement
%type <statement_> Statement
%type <listmnemonicargs_> ListMnemonicArgs
%type <mnemonicargs_> MnemonicArgs
%type <exp_> Exp
%type <factor_> Factor
%type <configtype_> ConfigType
%type <datatype_> DataType
%type <opcode_> Opcode

%start Program

%%

Program : ListStatement { std::reverse($1->begin(),$1->end()) ;$$ = new Prog($1); result->program_ = $$; }
;
ListStatement : Statement { $$ = new ListStatement(); $$->push_back($1); }
  | Statement ListStatement { $2->push_back($1); $$ = $2; }
;
Statement : T_Label { $$ = new LabelStmt($1); }
  | _IDENT_ _KW_EQU Exp { $$ = new DeclareStmt($1, $3); }
  | _LBRACK ConfigType _STRING_ _RBRACK { $$ = new ConfigStmt($2, $3); }
  | Opcode ListMnemonicArgs { std::reverse($2->begin(),$2->end()) ;$$ = new MnemonicStmt($1, $2); }
  | Opcode { $$ = new OpcodeStmt($1); }
;
ListMnemonicArgs : MnemonicArgs { $$ = new ListMnemonicArgs(); $$->push_back($1); }
  | MnemonicArgs _COMMA ListMnemonicArgs { $3->push_back($1); $$ = $3; }
;
MnemonicArgs : Exp { $$ = new MnemoArg($1); }
;
Exp : Exp _DEQ Exp { $$ = new EqExp($1, $3); }
  | Exp _BANGEQ Exp { $$ = new NeqExp($1, $3); }
  | Exp _LT Exp { $$ = new LtExp($1, $3); }
  | Exp _GT Exp { $$ = new GtExp($1, $3); }
  | Exp _LDARROW Exp { $$ = new LteExp($1, $3); }
  | Exp _GTEQ Exp { $$ = new GteExp($1, $3); }
  | Exp _PLUS Exp { $$ = new PlusExp($1, $3); }
  | Exp _MINUS Exp { $$ = new MinusExp($1, $3); }
  | Exp _STAR Exp { $$ = new MulExp($1, $3); }
  | Exp _SLASH Exp { $$ = new DivExp($1, $3); }
  | Exp _PERCENT Exp { $$ = new ModExp($1, $3); }
  | _LBRACK Exp _RBRACK { $$ = new IndirectAddrExp($2); }
  | DataType _LBRACK Exp _RBRACK { $$ = new DatatypeExp($1, $3); }
  | DataType Exp _COLON Exp { $$ = new RangeExp($1, $2, $4); }
  | T_Label { $$ = new LabelExp($1); }
  | Factor { $$ = new ImmExp($1); }
;
Factor : _INTEGER_ { $$ = new NumberFactor($1); }
  | T_Hex { $$ = new HexFactor($1); }
  | _IDENT_ { $$ = new IdentFactor($1); }
  | _STRING_ { $$ = new StringFactor($1); }
;
ConfigType : _KW_BITS { $$ = new BitsConfig(); }
  | _KW_INSTRSET { $$ = new InstConfig(); }
  | _KW_OPTIMIZE { $$ = new OptiConfig(); }
  | _KW_FORMAT { $$ = new FormConfig(); }
  | _KW_PADDING { $$ = new PaddConfig(); }
  | _KW_PADSET { $$ = new PadsConfig(); }
  | _KW_SECTION { $$ = new SectConfig(); }
  | _KW_ABSOLUTE { $$ = new AbsoConfig(); }
  | _KW_FILE { $$ = new FileConfig(); }
;
DataType : _KW_BYTE { $$ = new ByteDataType(); }
  | _KW_WORD { $$ = new WordDataType(); }
  | _KW_DWORD { $$ = new DwordDataType(); }
;
Opcode : _KW_AAA { $$ = new OpcodesAAA(); }
  | _KW_AAD { $$ = new OpcodesAAD(); }
  | _KW_AAS { $$ = new OpcodesAAS(); }
  | _KW_AAM { $$ = new OpcodesAAM(); }
  | _KW_ADC { $$ = new OpcodesADC(); }
  | _KW_ADD { $$ = new OpcodesADD(); }
  | _KW_AND { $$ = new OpcodesAND(); }
  | _KW_ALIGN { $$ = new OpcodesALIGN(); }
  | _KW_ALIGNB { $$ = new OpcodesALIGNB(); }
  | _KW_ARPL { $$ = new OpcodesARPL(); }
  | _KW_BOUND { $$ = new OpcodesBOUND(); }
  | _KW_BSF { $$ = new OpcodesBSF(); }
  | _KW_BSR { $$ = new OpcodesBSR(); }
  | _KW_BSWAP { $$ = new OpcodesBSWAP(); }
  | _KW_BT { $$ = new OpcodesBT(); }
  | _KW_BTC { $$ = new OpcodesBTC(); }
  | _KW_BTR { $$ = new OpcodesBTR(); }
  | _KW_BTS { $$ = new OpcodesBTS(); }
  | _KW_CALL { $$ = new OpcodesCALL(); }
  | _KW_CBW { $$ = new OpcodesCBW(); }
  | _KW_CDQ { $$ = new OpcodesCDQ(); }
  | _KW_CLC { $$ = new OpcodesCLC(); }
  | _KW_CLD { $$ = new OpcodesCLD(); }
  | _KW_CLI { $$ = new OpcodesCLI(); }
  | _KW_CLTS { $$ = new OpcodesCLTS(); }
  | _KW_CMC { $$ = new OpcodesCMC(); }
  | _KW_CMP { $$ = new OpcodesCMP(); }
  | _KW_CMPSB { $$ = new OpcodesCMPSB(); }
  | _KW_CMPSD { $$ = new OpcodesCMPSD(); }
  | _KW_CMPSW { $$ = new OpcodesCMPSW(); }
  | _KW_CMPXCHG { $$ = new OpcodesCMPXCHG(); }
  | _KW_CPUID { $$ = new OpcodesCPUID(); }
  | _KW_CWD { $$ = new OpcodesCWD(); }
  | _KW_CWDE { $$ = new OpcodesCWDE(); }
  | _KW_DAA { $$ = new OpcodesDAA(); }
  | _KW_DAS { $$ = new OpcodesDAS(); }
  | _KW_DB { $$ = new OpcodesDB(); }
  | _KW_DD { $$ = new OpcodesDD(); }
  | _KW_DEC { $$ = new OpcodesDEC(); }
  | _KW_DIV { $$ = new OpcodesDIV(); }
  | _KW_DQ { $$ = new OpcodesDQ(); }
  | _KW_DT { $$ = new OpcodesDT(); }
  | _KW_DW { $$ = new OpcodesDW(); }
  | _KW_END { $$ = new OpcodesEND(); }
  | _KW_ENTER { $$ = new OpcodesENTER(); }
  | _KW_EXTERN { $$ = new OpcodesEXTERN(); }
  | _KW_F2XM1 { $$ = new OpcodesF2XM1(); }
  | _KW_FABS { $$ = new OpcodesFABS(); }
  | _KW_FADD { $$ = new OpcodesFADD(); }
  | _KW_FADDP { $$ = new OpcodesFADDP(); }
  | _KW_FBLD { $$ = new OpcodesFBLD(); }
  | _KW_FBSTP { $$ = new OpcodesFBSTP(); }
  | _KW_FCHS { $$ = new OpcodesFCHS(); }
  | _KW_FCLEX { $$ = new OpcodesFCLEX(); }
  | _KW_FCOM { $$ = new OpcodesFCOM(); }
  | _KW_FCOMP { $$ = new OpcodesFCOMP(); }
  | _KW_FCOMPP { $$ = new OpcodesFCOMPP(); }
  | _KW_FCOS { $$ = new OpcodesFCOS(); }
  | _KW_FDECSTP { $$ = new OpcodesFDECSTP(); }
  | _KW_FDISI { $$ = new OpcodesFDISI(); }
  | _KW_FDIV { $$ = new OpcodesFDIV(); }
  | _KW_FDIVP { $$ = new OpcodesFDIVP(); }
  | _KW_FDIVR { $$ = new OpcodesFDIVR(); }
  | _KW_FDIVRP { $$ = new OpcodesFDIVRP(); }
  | _KW_FENI { $$ = new OpcodesFENI(); }
  | _KW_FFREE { $$ = new OpcodesFFREE(); }
  | _KW_FIADD { $$ = new OpcodesFIADD(); }
  | _KW_FICOM { $$ = new OpcodesFICOM(); }
  | _KW_FICOMP { $$ = new OpcodesFICOMP(); }
  | _KW_FIDIV { $$ = new OpcodesFIDIV(); }
  | _KW_FIDIVR { $$ = new OpcodesFIDIVR(); }
  | _KW_FILD { $$ = new OpcodesFILD(); }
  | _KW_FIMUL { $$ = new OpcodesFIMUL(); }
  | _KW_FINCSTP { $$ = new OpcodesFINCSTP(); }
  | _KW_FINIT { $$ = new OpcodesFINIT(); }
  | _KW_FIST { $$ = new OpcodesFIST(); }
  | _KW_FISTP { $$ = new OpcodesFISTP(); }
  | _KW_FISUB { $$ = new OpcodesFISUB(); }
  | _KW_FISUBR { $$ = new OpcodesFISUBR(); }
  | _KW_FLD { $$ = new OpcodesFLD(); }
  | _KW_FLD1 { $$ = new OpcodesFLD1(); }
  | _KW_FLDCW { $$ = new OpcodesFLDCW(); }
  | _KW_FLDENV { $$ = new OpcodesFLDENV(); }
  | _KW_FLDL2E { $$ = new OpcodesFLDL2E(); }
  | _KW_FLDL2T { $$ = new OpcodesFLDL2T(); }
  | _KW_FLDLG2 { $$ = new OpcodesFLDLG2(); }
  | _KW_FLDLN2 { $$ = new OpcodesFLDLN2(); }
  | _KW_FLDPI { $$ = new OpcodesFLDPI(); }
  | _KW_FLDZ { $$ = new OpcodesFLDZ(); }
  | _KW_FMUL { $$ = new OpcodesFMUL(); }
  | _KW_FMULP { $$ = new OpcodesFMULP(); }
  | _KW_FNCLEX { $$ = new OpcodesFNCLEX(); }
  | _KW_FNDISI { $$ = new OpcodesFNDISI(); }
  | _KW_FNENI { $$ = new OpcodesFNENI(); }
  | _KW_FNINIT { $$ = new OpcodesFNINIT(); }
  | _KW_FNOP { $$ = new OpcodesFNOP(); }
  | _KW_FNSAVE { $$ = new OpcodesFNSAVE(); }
  | _KW_FNSTCW { $$ = new OpcodesFNSTCW(); }
  | _KW_FNSTENV { $$ = new OpcodesFNSTENV(); }
  | _KW_FNSTSW { $$ = new OpcodesFNSTSW(); }
  | _KW_FPATAN { $$ = new OpcodesFPATAN(); }
  | _KW_FPTAN { $$ = new OpcodesFPTAN(); }
  | _KW_FPREM { $$ = new OpcodesFPREM(); }
  | _KW_FPREM1 { $$ = new OpcodesFPREM1(); }
  | _KW_FRNDINT { $$ = new OpcodesFRNDINT(); }
  | _KW_FRSTOR { $$ = new OpcodesFRSTOR(); }
  | _KW_FSAVE { $$ = new OpcodesFSAVE(); }
  | _KW_FSCALE { $$ = new OpcodesFSCALE(); }
  | _KW_FSETPM { $$ = new OpcodesFSETPM(); }
  | _KW_FSIN { $$ = new OpcodesFSIN(); }
  | _KW_FSINCOS { $$ = new OpcodesFSINCOS(); }
  | _KW_FSQRT { $$ = new OpcodesFSQRT(); }
  | _KW_FST { $$ = new OpcodesFST(); }
  | _KW_FSTCW { $$ = new OpcodesFSTCW(); }
  | _KW_FSTENV { $$ = new OpcodesFSTENV(); }
  | _KW_FSTP { $$ = new OpcodesFSTP(); }
  | _KW_FSTSW { $$ = new OpcodesFSTSW(); }
  | _KW_FSUB { $$ = new OpcodesFSUB(); }
  | _KW_FSUBP { $$ = new OpcodesFSUBP(); }
  | _KW_FSUBR { $$ = new OpcodesFSUBR(); }
  | _KW_FSUBRP { $$ = new OpcodesFSUBRP(); }
  | _KW_FTST { $$ = new OpcodesFTST(); }
  | _KW_FUCOM { $$ = new OpcodesFUCOM(); }
  | _KW_FUCOMP { $$ = new OpcodesFUCOMP(); }
  | _KW_FUCOMPP { $$ = new OpcodesFUCOMPP(); }
  | _KW_FXAM { $$ = new OpcodesFXAM(); }
  | _KW_FXCH { $$ = new OpcodesFXCH(); }
  | _KW_FXTRACT { $$ = new OpcodesFXTRACT(); }
  | _KW_FYL2X { $$ = new OpcodesFYL2X(); }
  | _KW_FYL2XP1 { $$ = new OpcodesFYL2XP1(); }
  | _KW_HLT { $$ = new OpcodesHLT(); }
  | _KW_IDIV { $$ = new OpcodesIDIV(); }
  | _KW_IMUL { $$ = new OpcodesIMUL(); }
  | _KW_IN { $$ = new OpcodesIN(); }
  | _KW_INC { $$ = new OpcodesINC(); }
  | _KW_INCO { $$ = new OpcodesINCO(); }
  | _KW_INSB { $$ = new OpcodesINSB(); }
  | _KW_INSD { $$ = new OpcodesINSD(); }
  | _KW_INSW { $$ = new OpcodesINSW(); }
  | _KW_INT { $$ = new OpcodesINT(); }
  | _KW_INT3 { $$ = new OpcodesINT3(); }
  | _KW_INTO { $$ = new OpcodesINTO(); }
  | _KW_INVD { $$ = new OpcodesINVD(); }
  | _KW_INVLPG { $$ = new OpcodesINVLPG(); }
  | _KW_IRET { $$ = new OpcodesIRET(); }
  | _KW_IRETD { $$ = new OpcodesIRETD(); }
  | _KW_IRETW { $$ = new OpcodesIRETW(); }
  | _KW_JA { $$ = new OpcodesJA(); }
  | _KW_JAE { $$ = new OpcodesJAE(); }
  | _KW_JB { $$ = new OpcodesJB(); }
  | _KW_JBE { $$ = new OpcodesJBE(); }
  | _KW_JC { $$ = new OpcodesJC(); }
  | _KW_JCXZ { $$ = new OpcodesJCXZ(); }
  | _KW_JE { $$ = new OpcodesJE(); }
  | _KW_JECXZ { $$ = new OpcodesJECXZ(); }
  | _KW_JG { $$ = new OpcodesJG(); }
  | _KW_JGE { $$ = new OpcodesJGE(); }
  | _KW_JL { $$ = new OpcodesJL(); }
  | _KW_JLE { $$ = new OpcodesJLE(); }
  | _KW_JMP { $$ = new OpcodesJMP(); }
  | _KW_JNA { $$ = new OpcodesJNA(); }
  | _KW_JNAE { $$ = new OpcodesJNAE(); }
  | _KW_JNB { $$ = new OpcodesJNB(); }
  | _KW_JNBE { $$ = new OpcodesJNBE(); }
  | _KW_JNC { $$ = new OpcodesJNC(); }
  | _KW_JNE { $$ = new OpcodesJNE(); }
  | _KW_JNG { $$ = new OpcodesJNG(); }
  | _KW_JNGE { $$ = new OpcodesJNGE(); }
  | _KW_JNL { $$ = new OpcodesJNL(); }
  | _KW_JNLE { $$ = new OpcodesJNLE(); }
  | _KW_JNO { $$ = new OpcodesJNO(); }
  | _KW_JNP { $$ = new OpcodesJNP(); }
  | _KW_JNS { $$ = new OpcodesJNS(); }
  | _KW_JNZ { $$ = new OpcodesJNZ(); }
  | _KW_JO { $$ = new OpcodesJO(); }
  | _KW_JP { $$ = new OpcodesJP(); }
  | _KW_JPE { $$ = new OpcodesJPE(); }
  | _KW_JPO { $$ = new OpcodesJPO(); }
  | _KW_JS { $$ = new OpcodesJS(); }
  | _KW_JZ { $$ = new OpcodesJZ(); }
  | _KW_LAHF { $$ = new OpcodesLAHF(); }
  | _KW_LAR { $$ = new OpcodesLAR(); }
  | _KW_LDS { $$ = new OpcodesLDS(); }
  | _KW_LEA { $$ = new OpcodesLEA(); }
  | _KW_LEAVE { $$ = new OpcodesLEAVE(); }
  | _KW_LES { $$ = new OpcodesLES(); }
  | _KW_LFS { $$ = new OpcodesLFS(); }
  | _KW_LGDT { $$ = new OpcodesLGDT(); }
  | _KW_LGS { $$ = new OpcodesLGS(); }
  | _KW_LIDT { $$ = new OpcodesLIDT(); }
  | _KW_LLDT { $$ = new OpcodesLLDT(); }
  | _KW_LMSW { $$ = new OpcodesLMSW(); }
  | _KW_LOCK { $$ = new OpcodesLOCK(); }
  | _KW_LODSB { $$ = new OpcodesLODSB(); }
  | _KW_LODSD { $$ = new OpcodesLODSD(); }
  | _KW_LODSW { $$ = new OpcodesLODSW(); }
  | _KW_LOOP { $$ = new OpcodesLOOP(); }
  | _KW_LOOPE { $$ = new OpcodesLOOPE(); }
  | _KW_LOOPNE { $$ = new OpcodesLOOPNE(); }
  | _KW_LOOPNZ { $$ = new OpcodesLOOPNZ(); }
  | _KW_LOOPZ { $$ = new OpcodesLOOPZ(); }
  | _KW_LSL { $$ = new OpcodesLSL(); }
  | _KW_LSS { $$ = new OpcodesLSS(); }
  | _KW_LTR { $$ = new OpcodesLTR(); }
  | _KW_MOV { $$ = new OpcodesMOV(); }
  | _KW_MOVSB { $$ = new OpcodesMOVSB(); }
  | _KW_MOVSD { $$ = new OpcodesMOVSD(); }
  | _KW_MOVSW { $$ = new OpcodesMOVSW(); }
  | _KW_MOVSX { $$ = new OpcodesMOVSX(); }
  | _KW_MOVZX { $$ = new OpcodesMOVZX(); }
  | _KW_MUL { $$ = new OpcodesMUL(); }
  | _KW_NEG { $$ = new OpcodesNEG(); }
  | _KW_NOP { $$ = new OpcodesNOP(); }
  | _KW_NOT { $$ = new OpcodesNOT(); }
  | _KW_OR { $$ = new OpcodesOR(); }
  | _KW_ORG { $$ = new OpcodesORG(); }
  | _KW_OUT { $$ = new OpcodesOUT(); }
  | _KW_OUTSB { $$ = new OpcodesOUTSB(); }
  | _KW_OUTSD { $$ = new OpcodesOUTSD(); }
  | _KW_OUTSW { $$ = new OpcodesOUTSW(); }
  | _KW_POP { $$ = new OpcodesPOP(); }
  | _KW_POPA { $$ = new OpcodesPOPA(); }
  | _KW_POPAD { $$ = new OpcodesPOPAD(); }
  | _KW_POPAW { $$ = new OpcodesPOPAW(); }
  | _KW_POPF { $$ = new OpcodesPOPF(); }
  | _KW_POPFD { $$ = new OpcodesPOPFD(); }
  | _KW_POPFW { $$ = new OpcodesPOPFW(); }
  | _KW_PUSH { $$ = new OpcodesPUSH(); }
  | _KW_PUSHA { $$ = new OpcodesPUSHA(); }
  | _KW_PUSHD { $$ = new OpcodesPUSHD(); }
  | _KW_PUSHAD { $$ = new OpcodesPUSHAD(); }
  | _KW_PUSHAW { $$ = new OpcodesPUSHAW(); }
  | _KW_PUSHF { $$ = new OpcodesPUSHF(); }
  | _KW_PUSHFD { $$ = new OpcodesPUSHFD(); }
  | _KW_PUSHFW { $$ = new OpcodesPUSHFW(); }
  | _KW_RCL { $$ = new OpcodesRCL(); }
  | _KW_RCR { $$ = new OpcodesRCR(); }
  | _KW_RDMSR { $$ = new OpcodesRDMSR(); }
  | _KW_RDPMC { $$ = new OpcodesRDPMC(); }
  | _KW_REP { $$ = new OpcodesREP(); }
  | _KW_REPE { $$ = new OpcodesREPE(); }
  | _KW_REPNE { $$ = new OpcodesREPNE(); }
  | _KW_REPNZ { $$ = new OpcodesREPNZ(); }
  | _KW_REPZ { $$ = new OpcodesREPZ(); }
  | _KW_RESB { $$ = new OpcodesRESB(); }
  | _KW_RESD { $$ = new OpcodesRESD(); }
  | _KW_RESQ { $$ = new OpcodesRESQ(); }
  | _KW_REST { $$ = new OpcodesREST(); }
  | _KW_RESW { $$ = new OpcodesRESW(); }
  | _KW_RET { $$ = new OpcodesRET(); }
  | _KW_RETF { $$ = new OpcodesRETF(); }
  | _KW_RETN { $$ = new OpcodesRETN(); }
  | _KW_ROL { $$ = new OpcodesROL(); }
  | _KW_ROR { $$ = new OpcodesROR(); }
  | _KW_RSM { $$ = new OpcodesRSM(); }
  | _KW_SAHF { $$ = new OpcodesSAHF(); }
  | _KW_SAL { $$ = new OpcodesSAL(); }
  | _KW_SAR { $$ = new OpcodesSAR(); }
  | _KW_SBB { $$ = new OpcodesSBB(); }
  | _KW_SCASB { $$ = new OpcodesSCASB(); }
  | _KW_SCASD { $$ = new OpcodesSCASD(); }
  | _KW_SCASW { $$ = new OpcodesSCASW(); }
  | _KW_SETA { $$ = new OpcodesSETA(); }
  | _KW_SETAE { $$ = new OpcodesSETAE(); }
  | _KW_SETB { $$ = new OpcodesSETB(); }
  | _KW_SETBE { $$ = new OpcodesSETBE(); }
  | _KW_SETC { $$ = new OpcodesSETC(); }
  | _KW_SETE { $$ = new OpcodesSETE(); }
  | _KW_SETG { $$ = new OpcodesSETG(); }
  | _KW_SETGE { $$ = new OpcodesSETGE(); }
  | _KW_SETL { $$ = new OpcodesSETL(); }
  | _KW_SETLE { $$ = new OpcodesSETLE(); }
  | _KW_SETNA { $$ = new OpcodesSETNA(); }
  | _KW_SETNAE { $$ = new OpcodesSETNAE(); }
  | _KW_SETNB { $$ = new OpcodesSETNB(); }
  | _KW_SETNBE { $$ = new OpcodesSETNBE(); }
  | _KW_SETNC { $$ = new OpcodesSETNC(); }
  | _KW_SETNE { $$ = new OpcodesSETNE(); }
  | _KW_SETNG { $$ = new OpcodesSETNG(); }
  | _KW_SETNGE { $$ = new OpcodesSETNGE(); }
  | _KW_SETNL { $$ = new OpcodesSETNL(); }
  | _KW_SETNLE { $$ = new OpcodesSETNLE(); }
  | _KW_SETNO { $$ = new OpcodesSETNO(); }
  | _KW_SETNP { $$ = new OpcodesSETNP(); }
  | _KW_SETNS { $$ = new OpcodesSETNS(); }
  | _KW_SETNZ { $$ = new OpcodesSETNZ(); }
  | _KW_SETO { $$ = new OpcodesSETO(); }
  | _KW_SETP { $$ = new OpcodesSETP(); }
  | _KW_SETPE { $$ = new OpcodesSETPE(); }
  | _KW_SETPO { $$ = new OpcodesSETPO(); }
  | _KW_SETS { $$ = new OpcodesSETS(); }
  | _KW_SETZ { $$ = new OpcodesSETZ(); }
  | _KW_SGDT { $$ = new OpcodesSGDT(); }
  | _KW_SHL { $$ = new OpcodesSHL(); }
  | _KW_SHLD { $$ = new OpcodesSHLD(); }
  | _KW_SHR { $$ = new OpcodesSHR(); }
  | _KW_SHRD { $$ = new OpcodesSHRD(); }
  | _KW_SIDT { $$ = new OpcodesSIDT(); }
  | _KW_SLDT { $$ = new OpcodesSLDT(); }
  | _KW_SMSW { $$ = new OpcodesSMSW(); }
  | _KW_STC { $$ = new OpcodesSTC(); }
  | _KW_STD { $$ = new OpcodesSTD(); }
  | _KW_STI { $$ = new OpcodesSTI(); }
  | _KW_STOSB { $$ = new OpcodesSTOSB(); }
  | _KW_STOSD { $$ = new OpcodesSTOSD(); }
  | _KW_STOSW { $$ = new OpcodesSTOSW(); }
  | _KW_STR { $$ = new OpcodesSTR(); }
  | _KW_SUB { $$ = new OpcodesSUB(); }
  | _KW_TEST { $$ = new OpcodesTEST(); }
  | _KW_TIMES { $$ = new OpcodesTIMES(); }
  | _KW_UD2 { $$ = new OpcodesUD2(); }
  | _KW_VERR { $$ = new OpcodesVERR(); }
  | _KW_VERW { $$ = new OpcodesVERW(); }
  | _KW_WAIT { $$ = new OpcodesWAIT(); }
  | _KW_WBINVD { $$ = new OpcodesWBINVD(); }
  | _KW_WRMSR { $$ = new OpcodesWRMSR(); }
  | _KW_XADD { $$ = new OpcodesXADD(); }
  | _KW_XCHG { $$ = new OpcodesXCHG(); }
  | _KW_XLATB { $$ = new OpcodesXLATB(); }
  | _KW_XOR { $$ = new OpcodesXOR(); }
;

%%


/* Entrypoint: parse Program* from file. */
Program* pProgram(FILE *inp)
{
  YYSTYPE result;
  yyscan_t scanner = nask__initialize_lexer(inp);
  if (!scanner) {
    fprintf(stderr, "Failed to initialize lexer.\n");
    return 0;
  }
  int error = yyparse(scanner, &result);
  nask_lex_destroy(scanner);
  if (error)
  { /* Failure */
    return 0;
  }
  else
  { /* Success */
    return result.program_;
  }
}

/* Entrypoint: parse Program* from string. */
Program* psProgram(const char *str)
{
  YYSTYPE result;
  yyscan_t scanner = nask__initialize_lexer(0);
  if (!scanner) {
    fprintf(stderr, "Failed to initialize lexer.\n");
    return 0;
  }
  YY_BUFFER_STATE buf = nask__scan_string(str, scanner);
  int error = yyparse(scanner, &result);
  nask__delete_buffer(buf, scanner);
  nask_lex_destroy(scanner);
  if (error)
  { /* Failure */
    return 0;
  }
  else
  { /* Success */
    return result.program_;
  }
}



